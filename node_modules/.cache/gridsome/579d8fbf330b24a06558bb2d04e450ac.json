{"remainingRequest":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/plpetkov/Development/kubb.in/kubb.in-frontend/src/pages/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/src/pages/Login.vue","mtime":1613745865500},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  metaInfo: {\n    title: \"Login Page\",\n  },\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      hidePassword: true,\n      jsonRequest: {},\n\n    };\n  },\n  mounted() {\nif (typeof window !== `undefined`) {\n  const user = localStorage.getItem(\"user\");\n  const tokenJSON = JSON.parse(user);\n      if (user != null) {\n      if (user.includes(\"ROLE_USER\")) {\n        window.location.href = \"/main\";\n      }\n    }\n  const redirectWithToken = (token) =>{\n  if (token !== undefined) {\n    localStorage.setItem(\"user\", JSON.stringify(token));\n    window.location.href = \"/main\";\n  }\n}\n\n\n\n}\n  },\n  computed: {\n    passwordType() {\n      return this.hidePassword ? \"password\" : \"text\";\n    },\n    passwordIcon() {\n      return this.hidePassword ? \"fa-eye\" : \"fa-eye-slash\";\n    },\n  },\n  methods: {\n    doLogin() {\n      if(typeof window !== 'undefined'){\n        sendLoginRequest(`${username.value}`, `${password.value}`);\n      }\n    },\n    checkIfLogged() {\n      console.log(\"jsontoken \", data.user);\n    },\n  },\n};\nconst redirectWithToken = (token) =>{\n  if(typeof window !== 'undefined'){\n      if (token !== undefined) {\n    localStorage.setItem(\"user\", JSON.stringify(token));\n    window.location.href = \"/main\";\n  }\n  }\n}\nfunction sendLoginRequest(u, p) {\n  var myHeaders = new Headers();\n  myHeaders.append(\"Content-Type\", \"application/json\");\n  var raw = JSON.stringify({ username: u, password: p });\n\n  var requestOptions = {\n    method: \"POST\",\n    headers: myHeaders,\n    body: raw,\n    redirect: \"follow\",\n  };\n\n  fetch(\"https://kubb.in:8080/api/auth/signin\", requestOptions)\n    .then((response) => response.json())\n    .then((result) =>\n      result.error\n        ? console.log(\"wrong password todo\")\n        : redirectWithToken(result)\n    )\n    .catch((error) => console.log(\"error\", error));\n}\n",null]}