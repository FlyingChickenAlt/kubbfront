{"remainingRequest":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/babel-loader/lib/index.js??ref--1-1!/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/plpetkov/Development/kubb.in/kubb.in-frontend/src/pages/Add.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/src/pages/Add.vue","mtime":1613747085331},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.string.link.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.timers.js\";\nimport _defineProperty from \"/home/plpetkov/Development/kubb.in/kubb.in-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Layout from \"~/layouts/Main.vue\";\nexport default _defineProperty({\n  metaInfo: {\n    title: \"Add a new Subscription\"\n  },\n  components: {\n    Layout: Layout\n  },\n  data: function data() {\n    return {\n      subname: \"\",\n      autorenewal: \"\",\n      currency: \"\",\n      price: \"\",\n      nextrenewal: \"\",\n      site: \"\",\n      regularity: \"\"\n    };\n  },\n  methods: {\n    sendRequestAddNewSubscription: function sendRequestAddNewSubscription() {\n      if (typeof window !== 'undefined') {\n        window.sendRequestAddNewSubscriptionf(JSON.parse(localStorage.getItem(\"user\")).accessToken, this.getFormObj());\n      }\n    },\n    getFormObj: function getFormObj() {\n      return {\n        name: this.subname,\n        autorenewal: this.autorenewal,\n        currency: this.currency,\n        price: this.price,\n        nextrenewal: this.nextrenewal,\n        site: this.site,\n        regularity: this.regularity\n      };\n    }\n  },\n  mounted: function mounted() {\n    if (typeof window !== \"undefined\") {\n      var user = localStorage.getItem(\"user\");\n      var tokenJSON = JSON.parse(user);\n      window.addEventListener(\"load\", function () {\n        if (tokenJSON == undefined || tokenJSON == null) {\n          window.location.href = \"/login\";\n        }\n      });\n\n      var processData = function processData(d) {\n        var table = document.getElementById(\"table-data\");\n        var header = document.getElementById(\"header-table\");\n        var row, cellar, cellcurr, celllink, cellname, cellnr, cellpri, cellreg, headCell;\n        d.forEach(function (element) {\n          row = document.createElement(\"tr\");\n          cellar = document.createElement(\"td\");\n          cellar.setAttribute(\"data-label\", \"Auto Renewal\");\n          cellcurr = document.createElement(\"td\");\n          cellcurr.setAttribute(\"data-label\", \"Currency\");\n          celllink = document.createElement(\"td\");\n          celllink.setAttribute(\"data-label\", \"Website\");\n          cellname = document.createElement(\"td\");\n          cellname.setAttribute(\"scope\", \"row\");\n          cellname.setAttribute(\"data-label\", \"Name\");\n          cellnr = document.createElement(\"td\");\n          cellnr.setAttribute(\"data-label\", \"Next Renewal\");\n          cellpri = document.createElement(\"td\");\n          cellpri.setAttribute(\"data-label\", \"Price\");\n          cellreg = document.createElement(\"td\");\n          cellreg.setAttribute(\"data-label\", \"Regularity\");\n          cellname.innerText = element.name;\n          celllink.innerText = element.link;\n          cellpri.innerText = element.price;\n          cellcurr.innerText = element.currency;\n          cellreg.innerText = element.regularity;\n          cellnr.innerText = element.nextRenewal.split(\"T\")[0];\n          cellar.innerText = element.autoRenewal === \"true\" ? \"Yes\" : \"No\";\n          row.append(cellname, celllink, cellpri, cellcurr, cellreg, cellnr, cellar);\n          table.appendChild(row);\n        });\n      };\n\n      var sendRequestForSubscriptions = function sendRequestForSubscriptions(token) {\n        var myHeaders = new Headers();\n        myHeaders.append(\"Authorization\", \"Bearer \".concat(token));\n        var requestOptions = {\n          method: \"GET\",\n          headers: myHeaders,\n          redirect: \"follow\"\n        };\n        fetch(\"https://kubb.in:8080/api/subscriptions/\", requestOptions).then(function (response) {\n          return response.json();\n        }).then(function (result) {\n          return processData(result);\n        })[\"catch\"](function (error) {\n          return console.log(\"error\", error);\n        });\n      };\n\n      var submitBtn = document.getElementById(\"submitBtn\");\n      /*\n      */\n\n      window.sendRequestAddNewSubscriptionf = function (token, sub) {\n        var validations = validateSub(sub);\n\n        if (validations) {\n          var myHeaders = new Headers();\n          myHeaders.append(\"Authorization\", \"Bearer \".concat(token));\n          myHeaders.append(\"Content-Type\", \"application/json\");\n          var raw = JSON.stringify({\n            autoRenewal: \"\".concat(sub.autorenewal),\n            currency: \"\".concat(sub.currency),\n            link: \"\".concat(sub.site),\n            name: \"\".concat(sub.name),\n            nextRenewal: \"\".concat(sub.nextrenewal),\n            price: \"\".concat(sub.price),\n            regularity: \"\".concat(sub.regularity)\n          });\n          var requestOptions = {\n            method: \"PUT\",\n            headers: myHeaders,\n            body: raw,\n            redirect: \"follow\"\n          };\n          fetch(\"https://kubb.in:8080/api/subscription/\", requestOptions).then(function (response) {\n            return response.text();\n          }).then(function (result) {\n            return window.location.reload();\n          })[\"catch\"](function (error) {\n            return console.log(\"error\", error);\n          });\n        }\n      };\n\n      var deleteAllSubs = function deleteAllSubs() {\n        var resp = prompt(\"Are You Sure? Type yes to continue\");\n\n        if (resp.toLowerCase() === \"yes\") {\n          var myHeaders = new Headers();\n          myHeaders.append(\"Authorization\", \"Bearer \".concat(tokenJSON.accessToken));\n          var requestOptions = {\n            method: \"DELETE\",\n            headers: myHeaders,\n            redirect: \"follow\"\n          };\n          fetch(\"https://kubb.in:8080/api/subscriptions/\", requestOptions).then(function (response) {\n            return response.text();\n          }).then(function (result) {\n            return window.location.reload();\n          })[\"catch\"](function (error) {\n            return console.log(\"error\", error);\n          });\n        }\n      };\n\n      var logout = function logout() {\n        localStorage.removeItem(\"user\");\n      };\n\n      var showAlert = function showAlert(alert) {\n        var alertParent = alert.parentElement;\n        var alertEle = document.createElement(\"div\");\n        alertEle.innerText = \"Wrong input, please introduce valid data\";\n        alertEle.className = \"alert alert-danger fade show\";\n        alertParent.insertBefore(alertEle, alert.parentElement.children[0]);\n        setTimeout(closeAlert, 2500);\n      };\n\n      var closeAlert = function closeAlert() {\n        //$(\".alert\").alert(\"close\");\n        document.getElementsByClassName(\"alert\")[0].remove();\n      };\n\n      var validateSub = function validateSub(sub) {\n        //name is not empty or null\n        if (sub.name == \"\" || sub.name == null || sub.name == undefined) {\n          showAlert(document.getElementById(\"name\"));\n          return false;\n        }\n\n        if (sub.site == \"\" || sub.site == null || sub.site == undefined) {\n          showAlert(document.getElementById(\"site\"));\n          return false;\n        } //price is only numbers\n\n\n        if (/[0-9]{1,}/.test(sub.price) != true || sub.price == null || sub.price == undefined) {\n          showAlert(price);\n          return false;\n        } //currency is only letters\n\n\n        if (sub.currency == \"\" || sub.currency == null || sub.currency == undefined) {\n          showAlert(currency);\n          return false;\n        } //regularity is only letters\n\n\n        if (sub.regularity == \"\" || sub.regularity == null || sub.regularity == undefined) {\n          showAlert(regularity);\n          return false;\n        }\n\n        if (sub.autorenewal != \"true\" && sub.autorenewal != \"false\" || sub.autorenewal == null || sub.autorenewal == undefined) {\n          showAlert(autorenewal);\n          return false;\n        }\n\n        return true;\n      };\n\n      if (tokenJSON != null) {\n        sendRequestForSubscriptions(tokenJSON.accessToken);\n      }\n    }\n  },\n  created: function created() {}\n}, \"metaInfo\", {\n  title: \"About us\"\n});",null]}